<!DOCTYPE html>
<html>
  <head>
    <title>Profile Picture Creator - Vaasavi and Aaron 2016</title>
    <script src="https://use.typekit.net/bdx7ivv.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <link rel="stylesheet" href="site.css" >
    <link rel="icon" type="image/png" href="favicon.png" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1522083631429252',
      xfbml      : true,
      version    : 'v2.5'
    });

    checkLoginState();
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "http://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));

function statusChangeCallback(response) {
  if (response.status === 'connected') {
    testAPI();
  }
}

function checkLoginState() {
  FB.getLoginStatus(function(response) {
    statusChangeCallback(response);
  });
}


function testAPI() {
  FB.api('/me/picture', {type:'square', height:'800'}, function(response) {
    if (response && !response.error) {
      var image = document.getElementById("basePic");
      image.src = response.data.url;
      image.onload = function() {
        makeImage();
      }
    }

  });
}

function makeImage() {
  document.getElementById('profPic').alt=
    "You need an HTML5 compatible browser to use this feature";

  var canvas = document.getElementById('profPicCanvas');
  var context = canvas.getContext("2d");

  // check where/how to crop image
  var image = document.getElementById("basePic");
  var crop = 0;
  if (image.width > image.height) {
    crop = (image.width - image.height)/2;
  }

  context.drawImage(document.getElementById("basePic"), crop, 0, 800, 800, 0, 0,
      800, 800);
  context.drawImage(document.getElementById("logoPic"), 20, 660, 200, 120);

  document.getElementById('profPic').src = canvas.toDataURL();
}
</script>

    <div class="header">
      <div class="mobile">
      <img src="logo.png">
      </div>
    </div>
    <div class="main">
    <nav class="desktop">
      <img src="logo.png">
      <ul class="clearfix">
        <li><a href="index.html#contact">Contact</a></li>
        <li><a href="index.html#team">Team</a></li>
        <li><a href="index.html#platform">Platform</a></li>
        <li><a href="index.html#about">About</a></li>
      </ul>
    </nav>

    <h2>Profile Picture Creator</h2>
    Login with Facebook to create your picture.

    <fb:login-button scope="public_profile" onlogin="checkLoginState();">
    </fb:login-button>

    <canvas id="profPicCanvas" width="800" height="800" class="hidden"></canvas>
    <img class="profPic" id="profPic" >

    <img id="basePic" crossOrigin="Anonymous" class="hidden">
    <img id="logoPic" src="logo.png" class="hidden">
  </body>
</html>
